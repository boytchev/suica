if(typeof THREE==='undefined')throw'error: Three.js must be loaded before Suica.js';console.log(`Suica 2.0.0 (220118) :: r${THREE.REVISION}`);const DEBUG_CALLS=!false;class Suica extends HTMLElement
{static current;static allSuicas=[];static DEFAULT={BACKGROUND:{COLOR:'white'},OXYZ:{COLOR:'black',SIZE:30},}
constructor()
{super();}
connectedCallback()
{this.style.display='inline-block';this.style.boxSizing='border-box';this.alreadyParsed=false;this.createCanvas();this.createRenderer();this.parseTag={};this.parseTag.OXYZ=this.parseTagOXYZ;this.parseTag.BACKGROUND=this.parseTagBACKGROUND;Suica.current=this;Suica.allSuicas.push(this);}
createCanvas()
{this.attachShadow({mode:'open'});if(this.clientWidth<1)
this.style.width=(this.getAttribute('width')||500)+'px';if(this.clientHeight<1)
this.style.height=(this.getAttribute('height')||300)+'px';this.canvas=document.createElement('canvas');this.canvas.width=this.clientWidth;this.canvas.height=this.clientHeight;var style=document.createElement('style');style.textContent=`canvas {

    border: none;

    width: 100%;

    height: 100%;

    box-sizing: border-box;

   }`;this.shadowRoot.append(style,this.canvas);}
get canvasAspect()
{return this.canvas.width/this.canvas.height;}
createRenderer()
{this.renderer=new THREE.WebGLRenderer({canvas:this.canvas,alpha:true,antialias:true});this.scene=new THREE.Scene();this.scene.background=new THREE.Color(getComputedStyle(this).backgroundColor);this.camera=new THREE.PerspectiveCamera(40,this.canvasAspect,1,1000);this.camera.position.set(0,0,100);this.camera.lookAt(this.scene.position);var light=new THREE.PointLight('white',1);light.position.set(100,150,300);this.scene.add(light);this.renderer.render(this.scene,this.camera);}
parseTagOXYZ(suica,elem)
{suica.oxyz(elem.getAttribute('size')||Suica.DEFAULT.OXYZ.SIZE,elem.getAttribute('color')||Suica.DEFAULT.OXYZ.COLOR);}
parseTagBACKGROUND(suica,elem)
{suica.background(elem.getAttribute('color')||Suica.DEFAULT.BACKGROUND.COLOR);}
parseTagsInElement(that,elem)
{for(var i=0;i<elem.children.length;i++)
{var tagName=elem.children[i].tagName;if(that.parseTag[tagName])
that.parseTag[tagName](that,elem.children[i]);else
throw`error: unknown tag in <${this.tagName}>`;that.parseTagsInElement(that,elem.children[i]);}}
parseTags()
{if(this.alreadyParsed)return;this.alreadyParsed=true;this.parseTagsInElement(this,this);}
background(color=Suica.DEFAULT.BACKGROUND.COLOR)
{this.parseTags();if(DEBUG_CALLS)console.log(`:: ${this.getAttribute('id')}.background( ${color} )`);this.scene.background=new THREE.Color(color);this.renderer.render(this.scene,this.camera);}
oxyz(size=Suica.DEFAULT.OXYZ.SIZE,color=Suica.DEFAULT.OXYZ.COLOR)
{this.parseTags();if(DEBUG_CALLS)console.log(`:: ${this.getAttribute('id')}.oxyz( ${size}, ${color} )`);var axes=new THREE.AxesHelper(size)
axes.setColors(color,color,color);this.scene.add(axes);this.renderer.render(this.scene,this.camera);}
static precheck()
{if(!(Suica.current instanceof Suica))
throw'error: No Suica instance is active';}
static tagId(id)
{return document.getElementById(id);}}
customElements.define('suica-canvas',Suica);function background(color=Suica.DEFAULT.BACKGROUND.COLOR)
{Suica.precheck();Suica.current.background(color);}
function oxyz(size=Suica.DEFAULT.OXYZ.SIZE,color=Suica.DEFAULT.OXYZ.COLOR)
{Suica.precheck();Suica.current.oxyz(size,color);}
tagId=Suica.tagId;window.addEventListener('load',function()
{for(var suica of Suica.allSuicas)
if(!suica.alreadyParsed)
suica.parseTags();});